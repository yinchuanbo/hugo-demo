---
title: "React è·¯ç”±v6"
date: 2022-10-23T09:41:12+08:00
---

### â… ã€è·¯ç”± v6 (ä¸¤ç§å½¢å¼)

**æ–¹æ¡ˆä¸€ ï¼š** ï¼ˆ ä¸æ¨è ï¼‰

- é€šè¿‡æ ‡ç­¾ åµŒå¥— æ ‡ç­¾ çš„å½¢å¼
- é€šè¿‡ Routes ä¸º åŒ…è£¹ Route æ ‡ç­¾çš„å½¢å¼

**ä¾‹ ï¼š** ç”¨æ³• ğŸ‘‡

```jsx
import { Route,Routes,BrowserRouter } from "react-router-dom";
import Page1 from '../view/Page1'
import Page2 from '../view/Page2'
import Page404 from '../view/Page404'

function App() {
  <BrowserRouter>
    <Routes>
        <Route  path='/page1' element = {<Page1 />} />
        <Route  path='/page2' element = {<Page2 />} />
        <Route  path='*' element = {<Page404 />} />
    <Routes>
  <BrowserRouter>
}

export default App;
```

- éœ€è¦æ·»åŠ å­è·¯ç”± å°±ç»§ç»­åµŒå¥—
- è¦åœ¨ <Page1 /> ç»„ä»¶ä¸‹ æ”¾å…¥ **<Outlet />** => ã€**ç¡®å®šå­è·¯ç”±**å‡ºç°çš„**ä½ç½®**ã€‘

**ä¾‹ ï¼š** å­è·¯ç”± ğŸ‘‡

```jsx
<Route path="/page1" element={<Page1 />}>
  <Route path="/page1/test1" element={<Test1 />} />
  <Route path="/page1/test2" element={<Test2 />} />
</Route>
```

**æ–¹æ¡ˆäºŒ ï¼š**ï¼ˆ æ¨è ï¼‰

- é€šè¿‡ react 17 ä¹‹åæ¨å‡ºçš„ hooks -> **useRoutes**
- è¿™ä¸ª hooks ï¼Œçœ‹èµ·æ¥æ›´åƒ vue çš„è·¯ç”±é…ç½®ï¼Œè€Œä¸æ˜¯å †æ ‡ç­¾ã€‚

**ä¾‹ ï¼š** App.jsx ğŸ‘‡

```jsx
import { BrowserRouter } from "react-router-dom";
import Element from "./routes";
function App() {
  return (
    <BrowserRouter>
      <Element />
    </BrowserRouter>
  );
}
export default App;
```

**ä¾‹ ï¼š** è·¯ç”±é…ç½® /routes/index.jsx ğŸ‘‡

```jsx
import { useRoutes } from "react-router-dom";
import Page1 from "../view/Page1";
import Page2 from "../view/Page2";
import Page404 from "../view/Page404";

function Element() {
  const element = useRoutes([
    {
      path: "/page1",
      element: <Page1 />,
    },
    {
      path: "/page2",
      element: <Page2 />,
    },
    {
      path: "*",
      element: LazyLoad("/view/404"),
    },
  ]);
  return element;
}
export default Element;
```

- å­è·¯ç”±å¯ä»¥é€šè¿‡ children æ¥åµŒå¥—å®ç°

**ä¾‹ ï¼š** å­è·¯ç”± ğŸ‘‡

```jsx
...
{
    path: '/page1',
    element: <Page1 />
    children: [
    	{
    	    path: '/page1/aaa',
            element: <Aaa />
    	},
    	{
    	    path: '/page1/bbb',
            element: <Baa />
    	}
    ]
}
...
```

---

### â…¡ã€ åŠ¨æ€è·¯ç”±

åŠ¨æ€è·¯ç”±çš„ä½œç”¨ï¼Œå°±æ˜¯åœ¨å»è¯¥è·¯ç”±çš„åŒæ—¶ï¼Œè¿˜èƒ½å¸¦å»ä¸€å®šçš„å‚æ•° ï¼Œè¾¾åˆ°**è·¯ç”±**è‡ªå®šä¹‰**ä¼ å‚**çš„ä½œç”¨

**â‘  ç»‘å®šå‚æ•°**  
**æ–¹æ¡ˆä¸€ ï¼š** ï¼ˆæ ‡ç­¾å½¢å¼ åˆ›å»ºçš„è·¯ç”±ï¼‰

```jsx
<Route path="/page1/:content" element={<Page1 />} />
```

**æ–¹æ¡ˆäºŒ ï¼š**ï¼ˆuseRoutes é’©å­åˆ›å»ºçš„è·¯ç”±ï¼‰

```jsx
...
{
	path: '/page1/:content',
    element: <Page1 />
},
...
```

**â‘¡ æ¥æ”¶å‚æ•°**

æ¥æ”¶çš„æ—¶å€™é€šè¿‡ **useParams** é’©å­å»æ¥æ”¶

```jsx
import { useParams } from "react-router-dom";
export default function Detail(props) {
  let { content } = useParams();
  return <div></div>;
}
```

---

### â…¢ã€è·¯ç”±[é‡å®šå‘](https://so.csdn.net/so/search?q=%E9%87%8D%E5%AE%9A%E5%90%91&spm=1001.2101.3001.7020)

**æ–¹æ¡ˆä¸€ ï¼š** ï¼ˆ é€šè¿‡ Navigate ï¼‰

```jsx
import { Navigate} from "react-router-dom";
...
{
    path: '*',
    element: <Navigate to='/page404'/>
},
...
```

**æ–¹æ¡ˆäºŒ ï¼š**( è‡ªå·±å°è£… )  
**ä¾‹ ï¼š** å°è£…ä¸€ä¸ªç»„ä»¶ ğŸ‘‡

```jsx
import React, { useEffect } from "react";
import { useNavigate } from "react-router-dom";
export default function Redirect(props) {
  const navigate = useNavigate();
  useEffect(() => {
    navigate(props.to, { replace: true });
  });
  return null;
}
```

**ä¾‹ ï¼š** ä½¿ç”¨ï¼šğŸ‘‡

```jsx
import Redirect from './Redirect'
{
    path: '*',
    element: <Redirect to='/page404'/>
},
```

---

### â…£ã€è·¯ç”±è·³è½¬ (ä¸¤ç§å½¢å¼)

**æ–¹æ¡ˆäºŒ ï¼š** ï¼ˆ æ ‡ç­¾ç±»å‹ ï¼š å’Œä¸Šé¢çš„ è·¯ç”±é‡å®šå‘ ä¸€æ · )

```jsx
import { NavLink } from "react-router-dom";
function Index() {
  return (
    <ul>
      <li>
        <NavLink to="page1"> é¡µé¢1 </NavLink>
      </li>
      <li>
        <NavLink to="page1"> é¡µé¢2 </NavLink>
      </li>
    </ul>
  );
}
```

**æ–¹æ¡ˆäºŒ ï¼š** ï¼ˆ æ–¹æ³•ç±»å‹ ï¼‰

```jsx
import { useNavigate } from "react-router-dom";
function Index() {
  return (
    <ul>
      <li
        onClick={() => {
          useNavigate("/page1");
        }}
      >
        é¡µé¢1
      </li>
      <li
        onClick={() => {
          useNavigate("/page2");
        }}
      >
        é¡µé¢2
      </li>
    </ul>
  );
}
```

---

### â…¤ã€è·¯ç”±[æ‡’åŠ è½½](https://so.csdn.net/so/search?q=%E6%87%92%E5%8A%A0%E8%BD%BD&spm=1001.2101.3001.7020)

1ã€è·¯ç”±æ‡’åŠ è½½ï¼Œå¯¹ä¸ **æ€§èƒ½** æ¥è¯´æ˜¯ä¸€ä¸ªéå¸¸å¥½çš„ **ä¼˜åŒ–ç‚¹** ;  
2ã€åªæœ‰åœ¨è¿›å…¥è¯¥è·¯ç”±çš„æ—¶å€™æ‰ï¼Œå» **æŒ‰éœ€åŠ è½½** å¯¹åº”çš„ï¼Œè€Œä¸æ˜¯ä¸€æ¬¡æ€§å»åŠ è½½å…¨éƒ¨;  
3ã€é€šè¿‡ React.lazy æ–¹æ³•æ¥æ‡’åŠ è½½ ;  
4\. åŒæ—¶å¯ä»¥é€šè¿‡ React.Suspense çš„ fallback å»å±•ç¤ºåŠ è½½ä¸­çš„ æ•ˆæœ ;

**ä¾‹ ï¼š** å°è£…ä¾‹å­ ğŸ‘‡ ( åŒæ—¶æ›´åŠ ç®€ä¾¿å¯¼å…¥ )

```jsx
import { useRoutes } from "react-router-dom";
import React from "react";

const LazyLoad = (path) => {
  //ä¼ å…¥åœ¨view ä¸‹çš„è·¯å¾„
  const Comp = React.lazy(() => import(`../view${path}`));
  return (
    <React.Suspense fallback={<> åŠ è½½ä¸­...</>}>
      <Comp />
    </React.Suspense>
  );
};

function Element() {
  const element = useRoutes([
    {
      path: "/page1",
      element: LazyLoad("/Page1"),
    },
    {
      path: "/page2",
      element: LazyLoad("/Page2"),
    },
  ]);
  return element;
}
export default Element;
```
