---
title: "å¼•åŠ›ç²’å­ç‰¹æ•ˆ"
date: 2023-03-27T22:25:34+08:00
---

![å¼•åŠ›ç²’å­ç‰¹æ•ˆ - å½’ä¸ºå°˜åŸƒ](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7f5fc53d5ed74c729a0bf80f0b3fcb6d~tplv-k3u1fbpfcp-zoom-crop-mark:1512:1512:1512:851.awebp?)

æœ€è¿‘çœ‹äº†ã€Šä¸‡ç¥æ®¿ã€‹ï¼Œé‡Œé¢çš„ä¸€ä¸ªæ•ˆæœè®©æˆ‘äº§ç”Ÿåˆ›ä½œçµæ„Ÿï¼š

![ç ´ç¢æ•ˆæœ.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1578f4e6e8f24a0b8749c4fff259c812~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp?)

> ä¸Šé¢äººç‰©ç ´ç¢çš„æ•ˆæœï¼Œä¸€ç‚¹ç‚¹è„±è½

ç„¶åï¼Œæˆ‘å®ç°äº†ä¸‹é¢çš„æ•ˆæœå¹¶å°†å…¶å‘½åä¸º`å½’ä¸ºå°˜åŸƒ` - å¯“æ„äºº(æˆ–è€…è¯´ä¸‡ç‰©)åœ¨å®‡å®™ä¸­çš„æ¸ºå°å­˜åœ¨ï¼š

![å½’ä¸ºå°˜åŸƒ.gif](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a6407af232f2486a8ac66940079b1a87~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp?)

æˆ‘ä»¬ä¸»è¦ä½¿ç”¨äº† `canvas` ç»˜å›¾ï¼Œä¸‹é¢æ¥ä¸€æ­¥æ­¥è®²è§£ï¼š

### åŸºæœ¬éª¨æ¶

`HTML` é‡Œé¢å°±ä¸¤è¡Œä»£ç ï¼š

```html
<canvas id="canvas"></canvas> <button id="start">Click to Start</button>
```

å—¯ï½ä¹Ÿè®¸ä½ ä¼šæœ‰ç–‘é—®ï¼š**å›¾ç‰‡è·‘å“ªé‡Œå»äº†å‘¢**ï¼Ÿ

å›¾ç‰‡æ”¾åœ¨äº† `javascript` æ–‡ä»¶ä¸­å¤„ç†ã€‚

### è‰²è°ƒæŒ‡å®š

åœ¨ç‰¹æ•ˆä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„å›¾ç‰‡æ˜¯è·¯é£ï¼Œå¦‚ä¸‹ï¼š

![lufei02.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a0aa2c4eb5de4c359bd210980fceca20~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp?)

> å›¾ç‰‡æ¥æºç½‘ç»œï¼Œä¾µåˆ 

æ ¹æ®å›¾ç‰‡çš„è‰²è°ƒï¼Œæˆ‘ä»¬æŒ‡å®šäº† `primaryColor`ï¼Œ`secondColor` å’Œ `accentColor` å¦‚ä¸‹ï¼Œå¹¶å¯¹å¼€å§‹æŒ‰é’®æ ·å¼åšäº†äº›åè°ƒè°ƒæ•´ï¼š

```scss
@primaryColor: #f00; // ä¸»è‰²è°ƒ
@secondColor: #fdb117; // æ¬¡è‰²è°ƒ
@accentColor: #fdac77; // å¼ºè°ƒè‰²

#start {
  cursor: pointer;
  position: absolute;
  text-align: center;
  top: 60px;
  left: 50%;
  padding: 3px 12px;
  transform: translateX(-50%);
  font-size: 20px;
  font-family: serif;
  border: 1px solid transparent;
  letter-spacing: 2px;
  background: linear-gradient(
    to bottom right,
    @primaryColor,
    @secondColor,
    @accentColor
  );
  -webkit-background-clip: text;
  color: transparent;
  border-image: linear-gradient(
      to top left,
      @primaryColor,
      @secondColor,
      @accentColor
    ) 1;
  &:hover {
    background: linear-gradient(
      to top left,
      @primaryColor,
      @secondColor,
      @accentColor
    );
    border-image: linear-gradient(
        to top left,
        @accentColor,
        @secondColor,
        @primaryColor
      ) 1;
    -webkit-background-clip: text;
    color: transparent;
  }
  text-shadow: 1px 1px 2px #000;
}
```

å…³äºç½‘ç«™ä¸­è‰²è°ƒçš„ä½¿ç”¨ï¼Œå¯ä»¥å‚è€ƒæˆ‘ä¹‹å‰çš„æ–‡ç«  -- [ç½‘ç«™è®¾è®¡ï¼šåæ¡éœ€é¿å…çš„å¸¸è§é”™è¯¯](https://juejin.cn/post/7213022785367097399)ã€‚

### ç»˜åˆ¶ç²’å­å›¾åƒ

æˆ‘ä»¬é€šè¿‡ `javascript` åŠ è½½ `onload` å›¾ç‰‡ä¹‹åï¼Œå†è¿›è¡Œå¤„ç†ï¼š

```javascript
const imgDom = new Image();
imgDom.src = ""; // å®é™…ä»£ç ä¸­ï¼Œæˆ‘å°†å›¾ç‰‡è½¬æ¢æˆ base64ï¼Œå½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨è¶…é“¾æ¥
// ç›‘å¬å›¾ç‰‡åŠ è½½å®Œåå¤„ç†
imgDom.onload = function () {
  // some code
};
```

é¦–å…ˆï¼Œæˆ‘ä»¬æ”¶é›†å›¾åƒæ•°æ®ï¼Œå­˜æ”¾åœ¨æŒ‡å®šçš„å˜é‡ä¸­ï¼Œå¦‚ `particleArray` ä¸­ï¼š

```javascript
function collectData() {
  particleArray = []; // è¿™é‡Œè¦é‡æ–°èµ‹å€¼ï¼ˆæ¸…ç©ºï¼‰ï¼Œé¿å…æµè§ˆå™¨çª—å£æ›´æ”¹ç­‰é€ æˆçš„ç²’å­è®°å…¥
  context.drawImage(imgDom, startX, startY); // ç»˜åˆ¶å›¾ç‰‡
  let i = 0;
  for (let y = 0; y < canvasDom.height; y += 1) {
    for (let x = 0; x < canvasDom.width; x += 1) {
      // rgba [i, i + 1, i + 2, i + 3]
      i = (y * canvasDom.width + x) * 4;
      let r = imgData[i];
      let g = imgData[i + 1];
      let b = imgData[i + 2];
      let color = `rgb(${r}, ${g}, ${b})`;
      let a = imgData[i + 3];
      if (a > 0) {
        particleArray.push({
          x,
          y,
          color,
          vx: 0,
          vy: 0,
          size: size * Math.random(),
        });
      }
    }
  }
}
```

é€šè¿‡ä¸Šé¢çš„å‡½æ•°ï¼Œæˆ‘ä»¬å°†å›¾ç‰‡è½¬æ¢æˆæ•°ç»„æ•°æ®ï¼Œæ¯ä¸ªç²’å­æ•°æ®é¡¹åŒ…å«ä¸‹é¢çš„å­—æ®µï¼š

```js
{
  x: x, // åæ ‡ç‚¹ x
  y: y, // åæ ‡ç‚¹ y
  color: color, // ç²’å­é¢œè‰²
  vx: 0, // x è½´çš„åŠ é€Ÿåº¦
  vy: 0, // y è½´çš„åŠ é€Ÿåº¦
  size: size * Math.random() // ç²’å­çš„å¤§å°
}
```

éœ€è¦ç•™æ„çš„æ˜¯ `color` è¿™ä¸ªå­—æ®µï¼Œç”Ÿæˆçš„ç²’å­æ•°ç»„ä¸­ï¼Œä»ç´¢å¼• `0` å¼€å§‹ï¼Œ**æ¯å››ä¸ªæ•°æ®ä¸ºä¸€ç»„**ï¼Œæ¯ç»„é‡Œé¢ä»å‰å¾€åä¾æ¬¡ä»£è¡¨è¯¥ç‚¹çš„**çº¢è‰²ã€ç»¿è‰²ã€è“è‰²å’Œé€æ˜åº¦**ã€‚

ç„¶åï¼Œæˆ‘ä»¬å°†ç²’å­æ•°æ®ç»˜åˆ¶å‡ºæ¥ï¼š

```javascript
function drawPaticleImage() {
  for (let i = 0; i < particleArray.length; i += 1) {
    let paticle = particleArray[i];
    context.fillStyle = paticle.color;
    context.fillRect(paticle.x, paticle.y, paticle.size, paticle.size); // ç»˜åˆ¶ç²’å­
  }
}
```

æ ¹æ®ä¸Šé¢å›¾åƒç»˜åˆ¶ç²’å­å›¾åƒï¼Œæ•ˆæœå¦‚ä¸‹ï¼š

![draw_image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/51eb3fef4cfe46209887259c495b6094~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp?)

å¾ˆä¸é”™ ğŸ‘ï¼Œå€¼å¾—ä¸€èµ

### æ·»åŠ å¼•åŠ›æ•ˆæœ

ä¸‹é¢æ˜¯æ•´ä¸ªé¡¹ç›®ä¸­çš„é‡ç‚¹ï¼Œä¹Ÿå°±æ˜¯æ·»åŠ å¼•åŠ›æ•ˆæœã€‚æˆ‘ä»¬è®¾ç½®äº†è§¦å‘å¼•åŠ›çš„ç‚¹ï¼š

```javascript
let gravitySource = {
  x: canvasDom.width / 2, // å¼•åŠ›åæ ‡ x
  y: canvasDom.height / 2, // å¼•åŠ›åæ ‡ y
  strength: 100, // å¼•åŠ›å¼ºåº¦
};
```

æ¥ç€è®¾ç½®å¼•åŠ›å‡½æ•°ï¼Œå¯¹ç²’å­äº§ç”Ÿç›¸åº”çš„å½±å“ï¼š

```javascript
function gravityAttractor(x, y, strength) {
  return function (paticle) {
    let dx = x - paticle.x;
    let dy = y - paticle.y;
    let distance = Math.sqrt(dx * dx + dy * dy);
    let angle = Math.atan2(dy, dx);
    let acceleration = strength / (distance * distance);
    paticle.vx += acceleration * Math.cos(angle);
    paticle.vy += acceleration * Math.sin(angle);
  };
}
```

è·å–å¼•åŠ›ç‚¹å¯¹ç²’å­çš„è·ç¦» `distance`ï¼Œå¼•åŠ›ç‚¹å¯¹ç²’å­çš„è§’åº¦ `angle`ï¼Œå½“å‰ç²’å­çš„åŠ é€Ÿåº¦ `acceleration` ï¼Œå½“å‰ç²’å­åœ¨ `x` è½´æ–¹å‘çš„åŠ é€Ÿåº¦å’Œå½“å‰ç²’å­åœ¨ `y` è½´æ–¹å‘ä¸Šçš„åŠ é€Ÿåº¦ã€‚æˆ‘ä»¬æ„Ÿå—ä¸‹æ•ˆæœï¼š

![å½’ä¸ºå°˜åŸƒ01.gif](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7b31912f8f7f46aabe7cdc976d251147~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp?)

å½“ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å°†å¼•åŠ›ç‚¹è®¾ç½®åœ¨ä¸åŒçš„ä½ç½®ï¼Œæ¯”å¦‚æ ¹æ®é¼ æ ‡çš„ç§»åŠ¨è€Œæ”¹å˜ï¼Œé‚£ä¼šå¾ˆé…·ï¼›æˆ–è€…è®¾ç½®å¤šä¸ªå¼•åŠ›æºï¼Œé‚£åˆä¼šæ˜¯æ€ä¹ˆæ ·å­çš„å‘¢ï¼Ÿè¯»è€…å¯ä»¥å°è¯•å®ç°ä¸€ä¸‹ã€‚

é¡¹ç›®æºç è§ï¼š [å½’ä¸ºå°˜åŸƒ](https://code.juejin.cn/pen/7214336219537211453)
