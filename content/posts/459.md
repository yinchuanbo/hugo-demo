---
title: "JavaScriptä¸­æ›´å®‰å…¨çš„URLè¯»å†™"
date: 2023-04-10T20:45:44+08:00
---

## å‰è¨€

`URL`å¯¹äºæˆ‘ä»¬å¼€å‘äººå‘˜æ¥è®²ï¼Œåº”è¯¥æ˜¯éå¸¸ç†Ÿæ‚‰äº†ã€‚åœ¨å¯¹`URL`è¿›è¡Œå‚æ•°æ‹¼æ¥æ—¶ï¼Œæˆ‘ä»¬ä¸€èˆ¬éƒ½ä¼šç›´æ¥è¿›è¡Œå­—ç¬¦ä¸²æ‹¼æ¥æˆ–ä½¿ç”¨æ¨¡ç‰ˆå­—ç¬¦ä¸²ï¼Œå› ä¸ºè¿™æ ·éå¸¸æ–¹ä¾¿ï¼Œä½†æ˜¯æˆ‘ä»¬è¿™æ ·å…¶å®ä¼šåœ¨ä¸çŸ¥ä¸è§‰ä¸­ä»¥ä¸å®‰å…¨çš„æ–¹å¼ç¼–å†™ URLã€‚

æ¯”å¦‚ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šè¿™æ ·å†™ï¼š

```js
const url = `https://www.baidu.com?model=${model}&locale=${locale}?query.text=${text}`;
```

è¿™æ ·ç¡®å®å†™èµ·æ¥éå¸¸æ–¹ä¾¿ï¼Œä½†ä½ å¯èƒ½ä¼šåœ¨ä¸çŸ¥ä¸è§‰ä¸­ä¼šä½ çš„ç¨‹åºå¸¦æ¥ä¸€äº›é—®é¢˜ã€‚ï¼ˆå¦‚ä¸Šä»£ç å°±æ˜¯ä¸€æ®µæœ‰é—®é¢˜çš„ä»£ç ï¼‰

## å¸¸è§é—®é¢˜

### ä¸æ­£ç¡®çš„åˆ†éš”ç¬¦

![1fg.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1fead5ff566a4e8b97297505513a89ff~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.awebp?)

è¿™ç§é”™è¯¯å¯èƒ½åœ¨æ–°æ‰‹èº«ä¸Šæ¯”è¾ƒå¸¸è§ï¼Œä½†å³ä½¿æ˜¯ç»éªŒè€é“çš„ç¨‹åºå‘˜ä¹Ÿä¸å¯èƒ½ç»å¯¹é¿å…è¿™ä¸ªé”™è¯¯ã€‚é€ æˆè¿™ä¸ªé”™è¯¯çš„ç½ªé­ç¥¸é¦–ç»å¤§å¤šæ•°æ˜¯åœ¨ä¿®æ”¹æˆ–ç§»åŠ¨ä»£ç ä¹‹åã€‚ä¾‹å¦‚ï¼Œä½ æœ‰ä¸€ä¸ªç»“æ„æ­£ç¡®çš„ URLï¼Œç„¶åå°†ä¸€ä¸ªç‰‡æ®µä»ä¸€ä¸ªç‰‡æ®µå¤åˆ¶åˆ°å¦ä¸€ä¸ªç‰‡æ®µï¼Œç„¶åé”™è¿‡äº†å‚æ•°åˆ†éš”ç¬¦çš„é”™è¯¯æ’åºã€‚

### å¿˜è®°ç¼–ç 

![2bm.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7d6f9ffa24fc48c29926ab356341c222~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.awebp?)

è®¸å¤šæ—¶å€™æˆ‘ä»¬`URL`ä¸Šçš„å‚æ•°æ˜¯éœ€è¦è¿›è¡Œç¼–ç çš„ï¼Œå› ä¸º`URL`å‚æ•°å¯ä»¥æ˜¯ä»»æ„ç±»å‹çš„æ–‡æœ¬ï¼ŒåŒ…æ‹¬ç©ºæ ¼å’Œç‰¹æ®Šå­—ç¬¦ï¼Œè¿™ä¼šç»™æˆ‘ä»¬å¸¦æ¥ä¸€äº›æ— æ³•é¢„æ–™çš„é—®é¢˜ã€‚

æ‰€ä»¥ä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬å¾€å¾€ä¼šè¿™æ ·å†™ï¼š

```js
const url = `https://www.baidu.com
  ?model=${encodeURIComponent(model)}&locale=${encodeURIComponent(
  locale
)}&query.text=${encodeURIComponent(text)}`;
```

ä½†è¿™æ ·çš„å†™æ³•ç»™äººçš„æ„Ÿè§‰æ˜¯éå¸¸çš„å†—ä½™ä¸”ä¸é›…è§‚ ğŸ˜“

### æ„å¤–çš„ç©ºç™½å­—ç¬¦

![3kb.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/033a4b66a4f94bc9ab451854a650d703~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.awebp?)

æœ‰æ—¶å€™æˆ‘ä»¬ä¸ºäº†å°†ä¸€ä¸ªé•¿ `URL` åˆ†æˆå¤šè¡Œï¼Œæˆ‘ä»¬ä¼šä¸å°å¿ƒåœ¨ URL ä¸­åŒ…å«äº†æ¢è¡Œç¬¦å’Œé¢å¤–çš„ç©ºæ ¼ï¼Œè¿™å°†å¯¼è‡´æ— æ³•æŒ‰é¢„æœŸè¿›è¡ŒæŠ“å–ã€‚

æ‰€ä»¥ä¸ºäº†æ­£ç¡®åˆ†è§£`URL`å­—ç¬¦ä¸²ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šè¿™æ ·å†™ï¼š

```js
const url =
  `https://www.baidu.com` +
  `?model=${encodeURIComponent(model)}&locale=${encodeURIComponent(
    locale
  )}&query.text=${encodeURIComponent(text)}`;
```

ä½†è¿™æ ·æ˜¯æˆ‘ä»¬çš„ä»£ç å˜å¾—æ›´åŠ æ··ä¹±ä»¥åŠéš¾ä»¥é˜…è¯»ã€‚

éš¾é“å°±æ²¡æœ‰ä¸€ç§æ—¢å®‰å…¨åˆä¼˜é›…çš„æ–¹æ³•æ¥ç¼–å†™`URL`å—ï¼ŸğŸ¤”

## URL æ„é€ å‡½æ•°

æ—¢ä¼˜é›…åˆå®‰å…¨çš„æ–¹æ³•å°±æ˜¯ä½¿ç”¨`URL`æ„é€ å‡½æ•°

> **`URL()`** æ„é€ å‡½æ•°è¿”å›ä¸€ä¸ªæ–°åˆ›å»ºçš„ `URL`å¯¹è±¡ï¼Œè¡¨ç¤ºç”±ä¸€ç»„å‚æ•°å®šä¹‰çš„ URLã€‚
>
> å¦‚æœç»™å®šçš„åŸºæœ¬ URL æˆ–ç”Ÿæˆçš„ URL ä¸æ˜¯æœ‰æ•ˆçš„ URL é“¾æ¥ï¼Œåˆ™ä¼šæŠ›å‡ºä¸€ä¸ª`TypeError`ã€‚

### è¯­æ³•

```js
const url = new URL(url [, base])
```

**å‚æ•°**

- `url`
  æ˜¯ä¸€ä¸ªè¡¨ç¤ºç»å¯¹æˆ–ç›¸å¯¹ URL çš„ [`DOMString`](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String)ã€‚å¦‚æœ`url` æ˜¯ç›¸å¯¹ URLï¼Œåˆ™ä¼šå°† `base` ç”¨ä½œåŸºå‡† URLã€‚å¦‚æœ `url` æ˜¯ç»å¯¹ URLï¼Œåˆ™æ— è®ºå‚æ•°`base`æ˜¯å¦å­˜åœ¨ï¼Œéƒ½å°†è¢«å¿½ç•¥
- `base` å¯é€‰
  æ˜¯ä¸€ä¸ªè¡¨ç¤ºåŸºå‡† URL çš„ [`DOMString`](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String)ï¼Œåœ¨ _url_ æ˜¯ç›¸å¯¹ URL æ—¶ï¼Œå®ƒæ‰ä¼šèµ·æ•ˆã€‚å¦‚æœæœªæŒ‡å®šï¼Œåˆ™é»˜è®¤ä¸º `''`

### è§£å†³

æ‰€ä»¥ä¸Šé¢çš„`URL`æˆ‘ä»¬å°±å¯ä»¥è¿™æ ·æ¥å†™ï¼š

```js
const url = new URL("https://www.baidu.com");

url.searchParams.set("model", model);
url.searchParams.set("locale", locale);
url.searchParams.set("text", text);
```

è¿™æ ·å†™å°±å¯ä»¥ä¸ºæˆ‘ä»¬è§£å†³è¿™äº›é—®é¢˜ï¼š

- åˆ†éš”ç¬¦æ€»æ˜¯æ­£ç¡®çš„ï¼ˆ`?`å¯¹äºç¬¬ä¸€ä¸ªå‚æ•°ï¼Œä»¥åŠä¹‹åçš„å‚æ•°ï¼‰
- æ‰€æœ‰å‚æ•°éƒ½è‡ªåŠ¨ç¼–ç 
- é•¿ URL è·¨å¤šè¡Œæ—¶æ²¡æœ‰é¢å¤–ç©ºç™½å­—ç¬¦çš„é£é™©

## ä¿®æ”¹ URL

å¯¹äºæˆ‘ä»¬åœ¨ä¸çŸ¥é“å½“å‰å‚æ•°çŠ¶æ€ä¸‹çš„æƒ…å†µï¼Œå®ƒä¹Ÿéå¸¸é€‚ç”¨ã€‚

æ¯”å¦‚ï¼š

```js
url += (url.includes("?") ? "&" : "?") + "foo=bar";
```

ä½¿ç”¨`URL`æ„é€ å‡½æ•°æˆ‘ä»¬å¯ä»¥è¿™æ ·å†™ï¼š

```js
// urlæ˜¯ä¸€ä¸ªURLæ„é€ å‡½æ•°
url.searchParams.set("foo", "bar");
// æˆ–è€…æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²
const structuredUrl = new URL(url);
structuredUrl.searchParams.set("foo", "bar");
url = structuredUrl.toString();
```

## è¯»å– URL

ç°åœ¨ï¼Œæˆ‘å¦‚æœæƒ³åœ¨æ²¡æœ‰åº“çš„æƒ…å†µä¸‹ä»å½“å‰ URL è¯»å–æŸ¥è¯¢å‚æ•°è¿™ä¸ªç”±æ¥å·²ä¹…çš„é—®é¢˜ä¹Ÿå¾—åˆ°äº†è§£å†³ã€‚

```js
const pageParam = new URL(location.href).searchParams.get("page");
const url = new URL(location.href);
const currentPage = Number(url.searchParams.get("page"));
url.searchParams.set("page", String(currentPage + 1));
location.href = url.toString();
```

è¿™ä¸ä»…é™äºæµè§ˆå™¨ï¼Œå®ƒä¹Ÿå¯ä»¥åœ¨ Node.js ä¸­ä½¿ç”¨

```js
const http = require("http");
const server = http.createServer((req, res) => {
  const url = new URL(req.url, `https://${req.headers.host}`);
});
```

## URL å±æ€§

URL å®ä¾‹æ”¯æŒæ‚¨å·²ç»åœ¨æµè§ˆå™¨ä¸­ä½¿ç”¨çš„æ‰€æœ‰å±æ€§ï¼Œä¾‹å¦‚ on`window.location`æˆ– anchor å…ƒç´ ï¼Œæ‰€æœ‰è¿™äº›æˆ‘ä»¬éƒ½å¯ä»¥*è¯»å†™*ï¼š

```js
const url = new URL("https://www.baidu.com/a?page=1");
url.protocol; // https:
url.host; // www.baidu.com
url.pathname; // /a
url.search; // ?page=1
url.href; // https://www.baidu.com/a?page=1
url.origin; // https://www.baidu.com
url.searchParams.get("page"); // 1
```

![4url.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/04eb3bc44a494f94b6a7b556c364f415~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.awebp?)

## å¸¸ç”¨ URLSearchParams æ–¹æ³•

è¯¥`URLSearchParams`å¯¹è±¡å¯åœ¨`URL`å®ä¾‹ä¸Šè®¿é—®ï¼Œ`url.searchParams`æ”¯æŒè®¸å¤šæ–¹ä¾¿çš„æ–¹æ³•ï¼š

### searchParams.has(name)

> æ£€æŸ¥æœç´¢å‚æ•°æ˜¯å¦åŒ…å«ç»™å®šåç§°

```js
url.searchParams.has("page"); // true
```

### searchParams.get(name)

> è·å–ç»™å®šå‚æ•°çš„å€¼

```js
url.searchParams.get("page"); // '1'
```

### searchParams.getAll(name)

> è·å–ä¸ºå‚æ•°æä¾›çš„æ‰€æœ‰å€¼ã€‚å¦‚æœä½ å…è®¸åŒåçš„å¤šä¸ªå€¼ï¼Œè¿™å¾ˆæ–¹ä¾¿ï¼Œä¾‹å¦‚`&page=1&page=2`

```js
url.searchParams.getAll("page"); // ['1']
```

### searchParams.set(name, value)

> è®¾ç½®å‚æ•°çš„å€¼

```js
url.searchParams.set("page", "1");
```

### searchParams.append(name, value)

> é™„åŠ ä¸€ä¸ªå‚æ•°â€”â€”å¦‚æœä½ å¯èƒ½å¤šæ¬¡æ”¯æŒåŒä¸€ä¸ªå‚æ•°ï¼Œè¿™å¾ˆæœ‰ç”¨ï¼Œæ¯”å¦‚`&page=1&page=2`

```js
url.searchParams.append("page", "2");
```

### searchParams.delete(name)

> ä» URL ä¸­å®Œå…¨åˆ é™¤ä¸€ä¸ªå‚æ•°

```js
url.searchParams.delete("page");
```

## å…¼å®¹æ€§

`new URL`åŸºæœ¬æ”¯æŒæ‰€æœ‰ç°ä»£æµè§ˆå™¨ï¼ˆé™¤äº† IEï¼‰ï¼Œä»¥åŠ Node.jsã€‚

![5urljr.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/aa0f7701926c4a128631a39079cb8cde~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.awebp?)
