---
title: "å‰ç«¯å®ç°ç‚¹å‡»é€‰è¯åŠŸèƒ½"
date: 2023-04-23T09:51:28+08:00
---

ä»Šå¤©æœ‰ä¸€ä¸ªéœ€æ±‚ï¼Œç‚¹å‡»é€‰ä¸­æŸä¸ªè‹±æ–‡å•è¯ï¼Œç„¶åå¯¹è¿™ä¸ªå•è¯åšä¸€äº›å¤„ç†ï¼Œä¾‹å¦‚é«˜äº®èƒŒæ™¯ã€æŸ¥çœ‹ä¸€äº›è¯¦ç»†ä¿¡æ¯ç­‰ç­‰ï¼Œä»Šå¤©ç®€å•å®ç°äº†ä¸€ä¸‹ï¼Œæ•ˆæœå¦‚ä¸‹ï¼šï¼ˆæ”¯æŒç§»åŠ¨ç«¯ï¼Œchrome å’Œ sarafi æµè§ˆå™¨å‡èƒ½æ­£å¸¸ä½¿ç”¨ã€‚è¯­è¨€ ğŸš€ [vue3](https://cn.vuejs.org/) + [typescript](https://www.typescriptlang.org/))

![highlight.gif](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3af2f49c280d4cdc95f68b01381aed15~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp?)

## é€‰è¯

ç”±äºè¦åŠ¨æ€æ·»åŠ ç»™æŸäº›å•è¯åŠ¨æ€æ·»åŠ ä¸€äº›æ ‡ç­¾ï¼Œæˆ‘ä»¬è¿™é‡Œå¯ä»¥è€ƒè™‘ä½¿ç”¨`v-html`ã€‚

é¦–å…ˆæˆ‘ä»¬å…ˆç¼–å†™ä¸€ä¸‹ç®€å•çš„ç»“æ„

```vue
<script setup lang="ts"></script>

<template>
  <div class="container" v-html="shortArticle"></div>
</template>

<style>
.container {
  font-size: 18px;
}
</style>
```

ç„¶åï¼Œæˆ‘ä»¬å°†éœ€è¦å¤„ç†çš„çŸ­æ–‡å˜æ¢ä¸º`span`æ ‡ç­¾åŒ…è£¹ï¼Œè¿™é‡Œçš„æ€è·¯æ˜¯æŒ‰ç…§ç©ºæ ¼åˆ’åˆ†ï¼Œç„¶åæ·»åŠ `span`ç»“æ„ï¼Œæœ€åæ‹¼æ¥åˆ°ä¸€èµ·è¿”å›ã€‚è¿™é‡Œæœ‰ä¸€äº›è¾¹ç¼˜æ¡ä»¶è¦è€ƒè™‘ï¼Œæ¯”å¦‚`can't`ã€`(which`ã€`yes!`ç­‰ç­‰ï¼ŒæŒ‰ç…§ç©ºæ ¼åˆ’åˆ†å‡ºæ¥çš„æ•°æ®æœ‰ä¸€ç‚¹é—®é¢˜ã€‚

![æˆªå±2023-04-19 20.48.19.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a9602d23644044cb884d462f3f123bad~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp?)

å¦‚æœä¸åšå¤„ç†çš„è¯ï¼Œä¸€äº›æ ‡ç‚¹ç¬¦å·ä¹Ÿä¼šé«˜äº®å‡ºæ¥ï¼Œå°±ä¸å¤ªæ­£ç¡®äº†ã€‚ä¸‹é¢æ˜¯å¤„ç†é€»è¾‘ï¼Œæ•´ä½“æ¯”è¾ƒç®€å•ï¼Œå°±ä¸è§£é‡Šäº†ã€‚

```ts
function addElementSpan(str: string): string {
  return str
    .split(" ")
    .map((item) => {
      const { start, word, end } = getWord(item);
      return `${start}<span>${word}</span>${end} `;
    })
    .join("");
}

function getWord(str: string) {
  let word = "";
  let start = "";
  let end = "";
  let j = str.length - 1;
  let i = 0;

  while (i < str.length) {
    if (/^[a-zA-Z]$/.test(str[i])) {
      break;
    }
    start = start + str[i];
    i += 1;
  }

  while (j >= 0) {
    if (/^[a-zA-Z]$/.test(str[j])) {
      break;
    }
    end = str[j] + end;
    j -= 1;
  }

  word = str.slice(i, j + 1);

  // å¤„ç†æ•°å­—
  if (!word && start === end) {
    start = "";
  }

  return {
    start,
    word,
    end,
  };
}
```

ç°åœ¨æˆ‘ä»¬æ¥å®ç°æ•ˆæœ

```vue
<script setup lang="ts">
import { computed } from "vue";
import { addElementSpan } from "./utils";

const str = `It works fine if you move the navbar outside the header. See below. For the reason, according to MDN: The element is positioned according to the normal flow of the document, and then offset
    relative to its flow root and containing block based on the values of top, right, bottom, and
    left. For the containing block: The containing block is the ancestor to which the element is
    relatively positioned So, when I do not misunderstand, the navbar is positioned at offset 0
    within the header as soon as it is scrolled outside the viewport (which, clearly, means, you
    can't see it anymore).`;

const shortArticle = computed(() => {
  return addElementSpan(str);
});

function setColor(event: any) {
  // console.log(event.target.innerText) è·å–é€‰ä¸­çš„æ–‡æœ¬
  event.target?.classList.add("word_highlight");
}
</script>

<template>
  <div class="container" @click="setColor($event)" v-html="shortArticle"></div>
</template>

<style>
.word_highlight {
  background-color: red;
}
</style>
```

åœ¨çˆ¶äº²å…ƒç´ ä¸Šæ·»åŠ ç‚¹å‡»äº‹ä»¶ï¼Œè§¦å‘äº‹ä»¶ç‚¹å‡»ä¹‹åï¼Œè°ƒç”¨`setColor`å‡½æ•°ï¼Œé«˜äº®èƒŒæ™¯ï¼ˆæ·»åŠ  classï¼‰

ä¸è¿‡æœ‰ä¸€ç‚¹å°å°çš„é—®é¢˜ï¼Œç‚¹å‡»`div`çš„ç©ºç™½åŒºåŸŸæˆ–è€…éè‹±æ–‡å•è¯åŒºåŸŸä¼šç›´æ¥æ•´ä¸ªèƒŒæ™¯å˜æˆçº¢è‰²ï¼Œæ§åˆ¶å°æ‰“å°`event.target.innerText`å¯ä»¥å‘ç°å®ƒçš„å€¼ä¸ºæ•´ä¸ªæ–‡æœ¬ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ ¹æ®åˆ¤æ–­æ‰“å°çš„æ–‡æœ¬é•¿åº¦å’Œéœ€è¦è®¾ç½®çš„æ–‡æœ¬é•¿åº¦æ˜¯å¦ä¸€è‡´æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ï¼ˆpsï¼šâ¬†ï¸ é¢çš„ç¤ºä¾‹ä»£ç `str`å­—ç¬¦ä¸²ä½¿ç”¨äº†åå¼•å· [æ¨¡æ¿å­—ç¬¦ä¸²](https://www.bookstack.cn/read/es6-3rd/spilt.5.docs-string.md) ï¼Œç›´æ¥ä½¿ç”¨ä¸‹é¢ä¼šå½±å“ç»“æœï¼‰

```js
function setColor(event: any) {
  // console.log(event.target.innerText)
  if (str !== event.target.innerText) {
    event.target?.classList.add("word_highlight");
  }
}
```

å¯¹äº`event.target`ä¸å¤ªäº†è§£çš„ä¼™ä¼´å¯ä»¥çœ‹è¿™ç¯‡æ–‡ç«  â¡ï¸ [Event.target - Web API æ¥å£å‚è€ƒ | MDN (mozilla.org)](https://developer.mozilla.org/zh-CN/docs/Web/API/Event/target)

(å’Œ`event.target`ç±»ä¼¼çš„è¿˜æœ‰ä¸€ä¸ªå±æ€§`event.currentTarget`ï¼Œä¸å¤ªäº†è§£çš„ä¼™ä¼´å¯ä»¥çœ‹ä¸‹è¿™ç¯‡æ–‡ç«  â¡ï¸ [Event.currentTarget - Web API æ¥å£å‚è€ƒ | MDN (mozilla.org)](https://developer.mozilla.org/zh-CN/docs/Web/API/Event/currentTarget)ï¼Œå®ƒä¿©çš„åŒºåˆ«æ˜¯`event.target`æŒ‡çš„æ˜¯äº‹ä»¶è§¦å‘çš„å…ƒç´ ï¼Œè€Œ`event.currentTarget`æŒ‡çš„æ˜¯äº‹ä»¶ç»‘å®šçš„å…ƒç´ ï¼‰

## åŠŸèƒ½æ‹“å±•

è¿™é‡Œåªæ˜¯æ¼”ç¤ºäº†ä¸€ä¸‹æ¯”è¾ƒç®€å•çš„èƒŒæ™¯é«˜äº®æ•ˆæœï¼Œæœ‰éœ€æ±‚çš„ä¼™ä¼´å¯ä»¥è‡ªå·±æ‹“å±•ä¸€ä¸‹ã€‚

æ¯”å¦‚ç±»ä¼¼äºæ˜é‡‘çš„æ‹¼å†™é”™è¯¯æç¤ºæ¡†

![æˆªå±2023-04-19 21.16.20.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e856bd10f2ee4be786733bfd0ecb67fc~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp?)

å¦‚æœè¦å®ç°æ»‘åŠ¨é€‰è¯çš„è¯ï¼Œå¯ä»¥å‚è€ƒè¿™ä¸ªåšä¸»çš„æ–‡ç«  â¡ï¸ [é¼ æ ‡é€‰ä¸­æ–‡æœ¬åˆ’è¯é«˜äº®ã€å†æ¬¡é€‰ä¸­åˆ’è¯å–æ¶ˆé«˜äº®æ•ˆæœ](https://juejin.cn/post/6844904101789040654)
