---
title: "å›¾è§£Jsç”Ÿæˆå™¨å’Œè¿­ä»£å™¨"
date: 2022-09-13T21:14:11+08:00
draft: false
tags: ['è¿­ä»£å™¨', 'ç”Ÿæˆå™¨']
---

<img src="/imgs/notes/3725692899-5f35014c888b9.gif"  />

ä¸‹é¢ä½¿ç”¨ `[...]` è¯­æ³•ï¼Œå°†ç”Ÿæˆçš„å€¼æ‰©å±•åˆ°ä¸€ä¸ªæ•°ç»„ä¸­å»

```js
function * getEmojis() {
    yield 1;
    yield 2;
    yield 3;
    yield 4;
}

const genObj = getEmojis();
console.log([...genObj]); // [1, 2, 3, 4]
```

æˆ–è€…ä½¿ç”¨ for...of å¾ªç¯

```js
function* getEmojis() {
    yield 1;
    yield 2;
    yield 3;
    yield 4;
}

const genObj = getEmojis();

for (let item of genObj) {
    console.log(item); // 1 2 3 4
}
```

æµ‹è¯•è¿­ä»£å™¨å±æ€§ï¼š

```js
const array = ['1', '2', '3']; // æ•°ç»„

const string = 'I love JavaScript!'; // å­—ç¬¦ä¸²

const object = { name: 'Lydia Hallie' }; // å¯¹è±¡

function regularFunction() { // å‡½æ•°
    return 'I am a basic function.';
}

function * generatorFunction() { // ç”Ÿæˆå™¨å‡½æ•°
    return 'I am a generator function';
}

const generatorObject = generatorFunction();

console.log(array[Symbol.iterator]); // Æ’ values() { [native code] }
console.log(string[Symbol.iterator]); // Æ’ [Symbol.iterator]() { [native code] }
console.log(generatorObject[Symbol.iterator]); // Æ’ [Symbol.iterator]() { [native code] }
console.log(object[Symbol.iterator]); // undefined
```

`[Symbol.iterator]` å¿…é¡»è¿”å›ä¸€ä¸ªè¿­ä»£å™¨ï¼Œè¯¥è¿­ä»£å™¨åŒ…å«ä¸€ä¸ª next() æ–¹æ³•ï¼Œè¯¥æ–¹æ³•è¿”å›ä¸€ä¸ªå¯¹è±¡ `{ value: '...', done: false/true }`

ä¸‹é¢è®© object å˜å¾—å¯è¿­ä»£ï¼š

```js
const object = { name: 'Lydia Hallie' };

object[Symbol.iterator] = function *() {
    yield this;
} 

console.log(object[Symbol.iterator]);

console.log([...object])

for(let item of object) {
    console.log(item)
}

// è·å–å¯¹è±¡çš„é”®å€¼
object[Symbol.iterator] = function *() {
    yield Object.keys(this);
} 
```

<img src="/imgs/notes/1712179175-5f35015559765.gif" />

æå®šï¼`Object.keys(this) `æ˜¯ä¸ªæ•°ç»„ï¼Œæ‰€ä»¥ç”Ÿæˆçš„å€¼ä¹Ÿæ˜¯ä¸€ä¸ªæ•°ç»„ã€‚ç„¶åæˆ‘ä»¬æŠŠè¿™ä¸ªç”Ÿæˆçš„æ•°ç»„æ‰©å±•åˆ°å¦ä¸€ä¸ªæ•°ç»„ä¸­ï¼Œç»“æœå°±å¾—åˆ°ä¸€ä¸ªåµŒå¥—çš„æ•°ç»„ã€‚æˆ‘ä»¬å¹¶ä¸æƒ³è¦è¿™ä¸ªï¼Œåªæ˜¯æƒ³ç”Ÿæˆæ¯ä¸ªå•ç‹¬çš„é”®ï¼

æˆ‘ä»¬å¯ä»¥ç”¨ `yield*` æ¥åšåˆ°è¿™ä¸€ç‚¹ã€‚ç„¶åæˆ‘ä»¬å§”æ‰˜ç»™å¦ä¸€ä¸ªç”Ÿæˆå™¨ï¼

```js
const emojis = ['ğŸ˜Š', 'ğŸ˜”', 'ğŸ˜Ÿ'];

function* genFunc() {
    yield 'â˜€';
    yield * emojis;
    yield 'ğŸš€';
}

const genObj = genFunc();

console.log([...genObj]); // ['â˜€', 'ğŸ˜Š', 'ğŸ˜”', 'ğŸ˜Ÿ', 'ğŸš€']
```

åœ¨ç»§ç»­è¿­ä»£ `genObj` è¿­ä»£å™¨ä¹‹å‰ï¼Œè¢«å§”æ‰˜çš„ç”Ÿæˆå™¨çš„æ¯ä¸ªå€¼éƒ½ç”Ÿæˆäº†ã€‚

<img src="/imgs/notes/4244762143-5f3501574238e.gif" />

ç”Ÿæˆå™¨å‡½æ•°çš„å¦ä¸€ç§ç”¨æ³•ï¼Œæ˜¯æˆ‘ä»¬å¯ä»¥ï¼ˆåœ¨æŸç§ç¨‹åº¦ä¸Šï¼‰å°†å®ƒä»¬ç”¨ä½œä¸ºè§‚å¯Ÿè€…å‡½æ•°ã€‚ç”Ÿæˆå™¨å¯ä»¥ç­‰å¾…ä¼ å…¥çš„æ•°æ®ï¼Œå¹¶ä¸”åªæœ‰å½“è¯¥æ•°æ®è¢«ä¼ é€’è¿‡æ¥æ—¶ï¼Œæ‰ä¼šå¤„ç†å®ƒã€‚æ¯”å¦‚ï¼š

```js
function * generatorFunction() {
    const second = yield 'First!';
    console.log(second);
    return 'All done';
}
```

è¿™é‡Œæœ€å¤§çš„åŒºåˆ«æ˜¯æˆ‘ä»¬ä¸æ˜¯åªæœ‰å‰ä¸€ä¸ªä¾‹å­ä¸­æ‰€çœ‹åˆ°çš„ `yield [value]`ï¼Œè€Œæ˜¯å°†å…¶èµ‹å€¼ç»™ä¸€ä¸ªç§°ä¸º `second` çš„å€¼ï¼Œå¹¶ç”Ÿæˆå€¼å­—ç¬¦ä¸² `First!`ã€‚è¿™æ˜¯ç¬¬ä¸€æ¬¡è°ƒç”¨ `next()`æ–¹æ³•æ—¶ä¼šç”Ÿæˆçš„å€¼ã€‚

<img src="/imgs/notes/3931143698-5f350158b51e5.gif" />

é¦–å…ˆé‡åˆ°ç¬¬ä¸€è¡Œä¸Šçš„ `yield`ï¼Œå¹¶ç”Ÿæˆå€¼ `First!`ã€‚é‚£ä¹ˆï¼Œå˜é‡ `second` çš„å€¼æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ

å˜é‡`second`çš„å€¼å®é™…ä¸Šæ˜¯ä¸‹æ¬¡æˆ‘ä»¬è°ƒç”¨ `next()` æ–¹æ³•æ—¶ä¼ é€’ç»™è¯¥æ–¹æ³•çš„å€¼ï¼è¿™ä¸€æ¬¡ï¼Œæˆ‘ä»¬ç»™`next()`æ–¹æ³•ä¼ ä¸€ä¸ªå­—ç¬¦ä¸²`'I like JavaScript'`ã€‚

<img src="/imgs/notes/337731807-5f35015a8915f.gif" />

ç”Ÿæˆå™¨çš„æœ€å¤§ä¼˜ç‚¹ä¹‹ä¸€å°±æ˜¯å®ƒä»¬æ˜¯æ‡’æ±‚å€¼çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨è°ƒç”¨`next()`æ–¹æ³•åè¿”å›çš„å€¼ä»…åœ¨æˆ‘ä»¬æ˜ç¡®è¦æ±‚åæ‰è®¡ç®—ï¼æ™®é€šå‡½æ•°æ²¡æœ‰è¿™ç§åŠŸèƒ½ï¼šæ‰€æœ‰å€¼éƒ½ä¸ºæˆ‘ä»¬ç”Ÿæˆäº†ï¼Œä»¥é˜²å°†æ¥æŸä¸ªæ—¶é—´éœ€è¦ç”¨åˆ°å®ƒã€‚

<img src="/imgs/notes/1597290365483-c1cd1dff-b66a-40b6-a334-4dc02e51e334.gif" />

##### æ¡ˆä¾‹

```js
const bookClubs = [{
    name: 'The Cool Club',
    clubMembers: [{
        name: 'John Doe',
        books: [{
            id: 'hs891',
            title: 'A Perfect'
        }, {
            id: 'ey812',
            title: 'A Good Book'
        }]
    }]
}, {
    name: 'The Better Club',
    clubMembers: [{
        name: 'John Doe',
        books: [{
            id: 'u8291',
            title: 'A Greet Book'
        }, {
            id: 'p9201',
            title: 'A Nice Book'
        }]
    }]
}];

// console.log(bookClubs);

function* iterateBooks(books) {
    for (let i = 0; i < books.length; i++) {
        yield books[i];
    }
}

function * iterateMember(members) {
    for(let i = 0; i < members.length; i++) {
        const clubMember = members[i];
        yield * iterateBooks(clubMember.books)
    }
}

function * iterateBookClubs(bookClubs) {
    for(let i = 0; i < bookClubs.length; i++) {
        const bookClub = bookClubs[i];
        yield * iterateMember(bookClub.clubMembers);
    }
}

// const it = iterateBookClubs(bookClubs);

// console.log(it.next())
// console.log(it.next())
// console.log(it.next())
// console.log(it.next())
// console.log(it.next())

function findBook(id) {
    const genObj = iterateBookClubs(bookClubs);
    let result = genObj.next();
    while(!result.done) {
        if(result.value.id === id) {
            return result.value;
        } else {
            result = genObj.next();
        }
    }
}

console.log(findBook('p9201')); // {id: 'p9201', title: 'A Nice Book'}
```

